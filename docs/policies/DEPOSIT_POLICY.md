# 약속금 정책 (Promise Deposit Policy)

> 혼밥시러 서비스의 약속금 제도에 관한 정책 문서입니다.

## 1. 약속금 개요

### 1.1 목적
- 모임 참가의 신뢰성 확보
- 노쇼(No-Show) 방지
- 건전한 모임 문화 조성

### 1.2 약속금 옵션
| 금액 | 권장 모임 유형 |
|------|---------------|
| 0원 | 약속금 없는 캐주얼 모임 |
| 3,000원 | 소규모/캐주얼 모임 |
| 5,000원 | 일반 모임 (기본 권장) |
| 10,000원 | 프리미엄/중요 모임 |

### 1.3 약속금 설정
- 모임 생성 시 호스트가 약속금 금액 선택
- 참가자는 참가 신청 시 약속금 결제 필수
- 호스트도 동일한 약속금 납부

---

## 2. 약속금 결제

### 2.1 결제 수단
1. **포인트 결제** (기본)
   - 보유 포인트에서 차감
   - 즉시 처리

2. **카드 결제**
   - 신용/체크카드
   - PG사 연동

3. **간편 결제**
   - 카카오페이
   - 네이버페이 (예정)

### 2.2 결제 시점
- 참가 신청 시 즉시 결제
- 호스트 승인 전까지는 '대기' 상태
- 호스트 승인 시 '확정' 상태로 변경

### 2.3 결제 실패 시
- 참가 신청 불가
- 포인트 부족 시 충전 안내
- 카드 결제 실패 시 재시도 안내

---

## 3. 약속금 환불

### 3.1 정상 환불 (100%)

| 상황 | 환불율 | 처리 방식 |
|------|--------|----------|
| 모임 정상 완료 | 100% | 자동 환불 |
| 모임 시작 1시간 전 자발적 취소 | 100% | 즉시 환불 |
| 시스템 취소 (정원 미달 등) | 100% | 자동 환불 |
| 호스트에 의한 모임 취소 | 100% | 자동 환불 |

### 3.2 부분 환불 (직전 취소)

> 모임 확정 후, 모임 시작 1시간 이내 취소 시 적용

| 취소 시점 | 환불율 | 몰수율 |
|----------|--------|--------|
| 40분 ~ 60분 전 | 60% | 40% |
| 20분 ~ 40분 전 | 30% | 70% |
| 10분 ~ 20분 전 | 0% | 100% |
| 10분 이내 | 0% | 100% |

### 3.3 환불 불가 (노쇼)

| 상황 | 환불율 | 처리 |
|------|--------|------|
| GPS 미인증 (출석 미확인) | 0% | 전액 몰수 |
| 후기에서 노쇼 확인됨 | 0% | 전액 몰수 |

### 3.4 환불 처리 방식
- **포인트 환불**: 즉시 포인트로 환급
- **카드 환불**: 3-5 영업일 소요
- **간편결제 환불**: 1-3 영업일 소요

---

## 4. 약속금 몰수

### 4.1 몰수 사유
1. 노쇼 (무단 불참)
2. 직전 취소 (환불 불가 구간)
3. 모임 규칙 위반으로 인한 퇴장

### 4.2 몰수금 분배

```
몰수된 약속금 = 피해자 배상금 (70%) + 플랫폼 수수료 (30%)
```

| 항목 | 비율 | 용도 |
|------|------|------|
| 피해자 배상금 | 70% | 노쇼로 피해 입은 참가자들에게 포인트 지급 |
| 플랫폼 수수료 | 30% | 서비스 운영 및 시스템 유지 |

### 4.3 배상금 분배 예시

**예시: 5,000원 약속금 모임에서 1명 노쇼**
- 몰수 금액: 5,000원
- 피해자 배상 총액: 3,500원 (70%)
- 플랫폼 수수료: 1,500원 (30%)

**피해자가 3명인 경우:**
- 1인당 배상: 3,500 ÷ 3 = 1,166원 (포인트)

---

## 5. 특수 상황

### 5.1 호스트 노쇼
- 호스트 약속금 전액 몰수
- 모든 참가자에게 100% 환불
- 추가 배상금 지급 (호스트 약속금의 70% 분배)
- 호스트 계정 페널티 부과

### 5.2 전원 노쇼
- 모든 참가자 약속금 몰수
- 플랫폼 수익으로 처리
- 참가자 전원 페널티 부과

### 5.3 부분 참석
- 출석자: 100% 환불
- 노쇼자: 환불 불가, 배상금 지급 대상

### 5.4 분쟁 발생
- 관리자 검토 후 결정
- 증거 자료 기반 판단 (GPS 기록, 채팅 내역 등)
- 결정에 대한 이의 신청 가능 (7일 이내)

---

## 6. 기술적 구현

### 6.1 데이터베이스 테이블
```sql
-- 약속금 테이블
promise_deposits (
  id, meetup_id, user_id, amount,
  status, payment_method, refund_rate,
  refund_amount, forfeited_amount,
  cancellation_type, ...
)

-- 노쇼 배상 테이블
noshow_compensations (
  id, meetup_id, noshow_user_id, victim_user_id,
  deposit_amount, compensation_amount, platform_fee,
  status, ...
)
```

### 6.2 API 엔드포인트
```
POST   /api/deposits/pay          - 약속금 결제
POST   /api/deposits/refund       - 약속금 환불 요청
GET    /api/deposits/:meetupId    - 약속금 상태 조회
POST   /api/deposits/forfeit      - 약속금 몰수 처리
GET    /api/compensations/my      - 내 배상금 내역
```

---

## 7. 정책 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2025-01-23 | 최초 작성 |

---

*본 정책은 서비스 운영 상황에 따라 변경될 수 있으며, 변경 시 사전 공지합니다.*

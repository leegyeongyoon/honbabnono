# 노쇼 정책 (No-Show Policy)

> 혼밥시러 서비스의 노쇼(무단 불참) 처리에 관한 정책 문서입니다.

## 1. 노쇼 정의

### 1.1 노쇼란?
- 모임에 참가 신청 및 승인을 받았으나 실제로 참석하지 않는 행위
- GPS 인증 없이 모임 시간이 지난 경우
- 다른 참가자들에 의해 불참이 확인된 경우

### 1.2 노쇼가 아닌 경우
- 정상적인 취소 절차를 거친 경우
- 시스템 오류로 인한 인증 실패 (증빙 필요)
- 불가항력적 사유 (증빙 필요)

---

## 2. 노쇼 판정

### 2.1 판정 기준 (2단계 확인)

```
┌─────────────────────────────────────────────────────┐
│                   1차 확인: GPS 인증                  │
├─────────────────────────────────────────────────────┤
│  모임 시작 ~ 종료 시간 내 GPS 인증 기록 확인           │
│  ├─ 인증 있음 → 정상 출석                            │
│  └─ 인증 없음 → 노쇼 의심 (2차 확인 진행)             │
└─────────────────────────────────────────────────────┘
                         ↓
┌─────────────────────────────────────────────────────┐
│                   2차 확인: 후기 검증                  │
├─────────────────────────────────────────────────────┤
│  다른 참가자들의 후기에서 노쇼 여부 확인              │
│  ├─ 2명 이상 노쇼 신고 → 노쇼 확정                   │
│  ├─ 1명 노쇼 신고 → 관리자 검토                      │
│  └─ 노쇼 신고 없음 → GPS 오류로 간주, 정상 처리       │
└─────────────────────────────────────────────────────┘
```

### 2.2 판정 타임라인

| 시점 | 이벤트 |
|------|--------|
| 모임 시작 | GPS 인증 가능 시작 |
| 모임 종료 | GPS 인증 마감 |
| 모임 종료 + 2시간 | 1차 노쇼 의심 판정 |
| 모임 종료 + 24시간 | 후기 작성 마감, 2차 판정 |
| 모임 종료 + 48시간 | 최종 노쇼 확정 및 처리 |

---

## 3. 노쇼 처리

### 3.1 노쇼자 페널티

| 항목 | 내용 |
|------|------|
| 약속금 | 전액 몰수 (환불 0%) |
| 밥알 점수 | -15점 |
| 평점 | 자동 1점 (피해자 리뷰) |
| 이력 기록 | 영구 기록 |

### 3.2 누적 제재

| 노쇼 횟수 | 제재 |
|----------|------|
| 1회 | 경고 알림 |
| 2회 | 밥알 점수 추가 -10 |
| 3회 | 서비스 이용 제한 7일 |
| 5회 | 서비스 이용 제한 30일 |
| 10회 | 영구 이용 제한 |

---

## 4. 피해자 배상

### 4.1 배상 정책

```
노쇼자 약속금 = 피해자 배상금 (70%) + 플랫폼 수수료 (30%)
```

### 4.2 배상금 분배

**배상금 계산:**
```javascript
피해자 1인당 배상금 = (노쇼자 약속금 × 0.7) ÷ 출석한 참가자 수
```

**예시:**
- 약속금: 5,000원
- 노쇼자: 1명
- 출석자: 3명

```
총 몰수금: 5,000원
피해자 배상 총액: 5,000 × 0.7 = 3,500원
1인당 배상금: 3,500 ÷ 3 = 1,166원
플랫폼 수수료: 5,000 × 0.3 = 1,500원
```

### 4.3 배상금 지급

| 항목 | 내용 |
|------|------|
| 지급 형태 | 포인트 |
| 지급 시점 | 노쇼 확정 후 24시간 이내 |
| 알림 | 푸시 알림 + 앱 내 알림 |

---

## 5. 후기에서 노쇼 확인

### 5.1 후기 질문

모임 종료 후 참가자에게 후기 작성 시 다음 질문 포함:

```
Q: 이 모임에서 노쇼(무단 불참)한 참가자가 있었나요?

[ ] 없음 - 모두 참석했습니다
[ ] 있음 - 아래에서 선택해주세요
    └─ [ ] 참가자A
    └─ [ ] 참가자B
    └─ [ ] ...
```

### 5.2 노쇼 신고 가중치

| 신고자 | 가중치 |
|--------|--------|
| 호스트 | 2배 (즉시 확정 가능) |
| 일반 참가자 | 1배 |

### 5.3 허위 신고 방지

- GPS 기록과 교차 검증
- 허위 신고 적발 시 신고자 페널티
- 분쟁 시 채팅 기록 확인

---

## 6. 호스트 노쇼

### 6.1 호스트 노쇼의 심각성
- 모든 참가자가 피해
- 더 강력한 페널티 적용

### 6.2 호스트 노쇼 처리

| 항목 | 내용 |
|------|------|
| 호스트 약속금 | 전액 몰수 |
| 참가자 약속금 | 100% 환불 |
| 추가 배상 | 호스트 몰수금의 70%를 참가자에게 분배 |
| 밥알 점수 | -30점 |
| 호스트 자격 | 30일 정지 |

---

## 7. 특수 상황

### 7.1 부분 노쇼 (일부만 참석)

```
예: 4명 모임에서 2명 노쇼

처리:
1. 노쇼자 2명의 약속금 각각 몰수
2. 출석자 2명에게 배상금 분배
3. 출석자 약속금은 100% 환불
```

### 7.2 전원 노쇼

- 모든 참가자 약속금 몰수
- 배상 대상 없음 (플랫폼 수익)
- 전원 노쇼 페널티 적용

### 7.3 GPS 인증 불가 상황

| 상황 | 처리 |
|------|------|
| 지하/실내 GPS 약함 | QR 코드 or 호스트 확인으로 대체 |
| 휴대폰 분실/고장 | 다른 참가자 증언으로 출석 인정 |
| 앱 오류 | 고객센터 문의, 증빙 후 환불 |

---

## 8. 기술적 구현

### 8.1 데이터베이스

```sql
-- 노쇼 배상 기록
noshow_compensations (
  meetup_id,
  noshow_user_id,      -- 노쇼한 사람
  victim_user_id,      -- 피해자
  deposit_amount,      -- 원래 약속금
  compensation_amount, -- 배상금 (70%)
  platform_fee,        -- 수수료 (30%)
  status,              -- pending, paid, cancelled
  paid_at
)

-- 참가자 테이블 (노쇼 플래그)
meetup_participants (
  ...
  no_show BOOLEAN DEFAULT false,
  no_show_confirmed BOOLEAN DEFAULT false
)

-- 후기 테이블 (노쇼 신고)
user_reviews (
  ...
  reported_noshow BOOLEAN DEFAULT false
)
```

### 8.2 노쇼 판정 로직

```javascript
async function determineNoShow(meetupId) {
  // 1. GPS 미인증 참가자 조회
  const unverified = await getUnverifiedParticipants(meetupId);

  // 2. 후기에서 노쇼 신고 확인
  for (const participant of unverified) {
    const noshowReports = await getNoshowReports(meetupId, participant.userId);

    // 호스트 신고 = 즉시 확정
    if (noshowReports.some(r => r.isHost)) {
      await confirmNoShow(meetupId, participant.userId);
      continue;
    }

    // 2명 이상 신고 = 확정
    if (noshowReports.length >= 2) {
      await confirmNoShow(meetupId, participant.userId);
    }
  }

  // 3. 배상 처리
  await processCompensations(meetupId);
}
```

### 8.3 API 엔드포인트

```
POST   /api/meetups/:id/report-noshow         - 노쇼 신고
GET    /api/meetups/:id/noshow-status         - 노쇼 현황 조회
POST   /api/noshow/process                    - 노쇼 처리 실행 (관리자)
GET    /api/compensations/my                  - 내 배상금 내역
POST   /api/noshow/appeal                     - 노쇼 판정 이의 신청
```

---

## 9. 알림

### 9.1 노쇼자에게

```
[혼밥시러] 노쇼 처리 알림

OO님, 1/23 강남역 점심 모임에 참석하지 않으셨습니다.

- 약속금 5,000원이 몰수되었습니다.
- 밥알 점수가 15점 감소했습니다.
- 누적 노쇼 횟수: 2회

※ 이의가 있으시면 고객센터로 문의해주세요.
```

### 9.2 피해자에게

```
[혼밥시러] 노쇼 배상 안내

OO님, 1/23 강남역 점심 모임에서
노쇼자의 약속금 일부가 배상되었습니다.

- 배상금: 1,166 포인트
- 지급 방식: 포인트 적립

불편을 드려 죄송합니다.
```

---

## 10. 정책 변경 이력

| 버전 | 날짜 | 변경 내용 |
|------|------|----------|
| 1.0 | 2025-01-23 | 최초 작성 |

---

*본 정책은 서비스 운영 상황에 따라 변경될 수 있으며, 변경 시 사전 공지합니다.*
